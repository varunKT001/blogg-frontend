<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login/register</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="CSS/loading-screen.css">
    <link rel="stylesheet" href="CSS/notification.css">
    <link rel="stylesheet" href="CSS/index.css">
    <script>
        const serverURL = 'https://blogg-server.herokuapp.com/'
        const siteURL = 'https://letsblogg.netlify.app/'
        if (localStorage.getItem("token")) {
            const token = localStorage.getItem("token");
            let status = verifySessionStatus(token);
            if (status) {
                location.replace(`${siteURL}/views/homepage/homepage.html`)
            }
            else {
                localStorage.removeItem('token')
            }
        }
        async function verifySessionStatus(token) {
            let response = await fetch(`${serverURL}/auth/verifyToken`, {
                method: "GET",
                headers: {
                    "Content-Type": "application/json",
                    Authorization: "Bearer" + " " + token,
                },
            });
            response = await response.json();
            if ((response.message = "verified")) {
                return true;
            } else {
                return false;
            }
        }
    </script>
</head>
<body>
    <div class="loading-screen">
        <div class="loading-screen-image"><img src="assets/images/logo.png" alt=""></div>
        <div class="loader-animation">
            <div class="loader-one"></div>
            <div class="loader-two"></div>
            <div class="loader-three"></div>
        </div>
    </div>
    <main>
        <div class="register-form">
            <div class="logo">
                <img src="assets/images/logo.png" alt="">
            </div>
            <h1>Register</h3>
            <div id="notification">
                <span id="notification-text"></span>
                <span class="material-icons close-button">close</span>
            </div>
            <div class="form-data">
                <input type="text" id="username" placeholder="Username">
                <input type="text" id="name" placeholder="Full Name">
                <input type="email" id="email" placeholder="Email">
                <input type="password" id="password" placeholder="Password">
                <button id="submit-register">Register</button>
            </div>
            <span>Already Registered?<a href="/login.html"> Login</a></span>
        </div>
    </main>
    <script src="JS/index.js"></script>
</body>
</html>